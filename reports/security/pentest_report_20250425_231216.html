<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryoProtect v2 Security Penetration Test Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3, h4 {
            color: #2c3e50;
        }
        .header {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .summary {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .summary-status {
            font-size: 1.2em;
            font-weight: bold;
        }
        .passed {
            color: #27ae60;
        }
        .partial {
            color: #f39c12;
        }
        .failed {
            color: #e74c3c;
        }
        .category {
            margin-bottom: 30px;
        }
        .test {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .test-name {
            font-weight: bold;
            font-size: 1.1em;
        }
        .test-result {
            font-weight: bold;
            padding: 3px 8px;
            border-radius: 3px;
            color: white;
        }
        .test-result.passed {
            background-color: #27ae60;
        }
        .test-result.failed {
            background-color: #e74c3c;
        }
        .test-details {
            background-color: #f8f9fa;
            border-radius: 3px;
            padding: 10px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .severity {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        .severity.high {
            color: #e74c3c;
        }
        .severity.medium {
            color: #f39c12;
        }
        .severity.low {
            color: #3498db;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CryoProtect v2 Security Penetration Test Report</h1>
        <p>Generated: 2025-04-25 23:12:16</p>
        <p>Target: http://localhost:5000</p>
    </div>
    
    <div class="summary">
        <h2>Summary</h2>
        <p class="summary-status failed">
            Overall Status: FAILED
        </p>
        <p>Pass Rate: 14.29%</p>
        <p>Tests Passed: 1 / 7</p>
        <p>Tests Failed: 6</p>
    </div>
    
    <h2>Test Results by Category</h2>

    <div class="category">
        <h3>CSRF Protection</h3>

        <div class="test">
            <div class="test-header">
                <span class="test-name">csrf_token_endpoint</span>
                <span class="test-result failed">FAILED</span>
            </div>
            <div class="severity high">Severity: HIGH</div>

            <div class="test-details">
{
  "response": null
}
            </div>

        </div>

        <div class="test">
            <div class="test-header">
                <span class="test-name">csrf_protection_enforced</span>
                <span class="test-result failed">FAILED</span>
            </div>
            <div class="severity high">Severity: HIGH</div>

            <div class="test-details">
{
  "error": "Could not obtain CSRF token for testing"
}
            </div>

        </div>

    </div>

    <div class="category">
        <h3>Security Headers</h3>

        <div class="test">
            <div class="test-header">
                <span class="test-name">security_headers_present</span>
                <span class="test-result failed">FAILED</span>
            </div>
            <div class="severity high">Severity: HIGH</div>

            <div class="test-details">
{
  "headers_present": {},
  "missing_headers": [
    "Content-Security-Policy",
    "Strict-Transport-Security",
    "X-Content-Type-Options",
    "X-Frame-Options",
    "X-XSS-Protection",
    "Referrer-Policy",
    "Permissions-Policy"
  ]
}
            </div>

        </div>

    </div>

    <div class="category">
        <h3>Cookie Security</h3>

        <div class="test">
            <div class="test-header">
                <span class="test-name">secure_cookies</span>
                <span class="test-result failed">FAILED</span>
            </div>
            <div class="severity high">Severity: HIGH</div>

            <div class="test-details">
{
  "error": "Could not authenticate to test cookies"
}
            </div>

        </div>

    </div>

    <div class="category">
        <h3>Encryption at Rest</h3>

        <div class="test">
            <div class="test-header">
                <span class="test-name">encryption_at_rest</span>
                <span class="test-result failed">FAILED</span>
            </div>
            <div class="severity high">Severity: HIGH</div>

            <div class="test-details">
{
  "error": "Could not create test data",
  "status_code": null
}
            </div>

        </div>

    </div>

    <div class="category">
        <h3>Vulnerability Scanning</h3>

        <div class="test">
            <div class="test-header">
                <span class="test-name">vulnerability_scan_scripts</span>
                <span class="test-result passed">PASSED</span>
            </div>
            <div class="severity high">Severity: HIGH</div>

            <div class="test-details">
{
  "scripts_exist": [
    "security/scan_python_bandit.py",
    "security/scan_python_safety.py",
    "security/scan_js_eslint.js"
  ],
  "scripts_missing": []
}
            </div>

        </div>

        <div class="test">
            <div class="test-header">
                <span class="test-name">vulnerability_scan_execution</span>
                <span class="test-result failed">FAILED</span>
            </div>
            <div class="severity high">Severity: HIGH</div>

            <div class="test-details">
{
  "returncode": 1,
  "stdout": "Collecting bandit\n  Downloading bandit-1.8.3-py3-none-any.whl.metadata (7.0 kB)\nRequirement already satisfied: PyYAML>=5.3.1 in c:\\users\\1edwa\\anaconda3\\envs\\cryoprotect\\lib\\site-packages (from bandit) (6.0.2)\nCollecting stevedore>=1.20.0 (from bandit)\n  Downloading stevedore-5.4.1-py3-none-any.whl.metadata (2.3 kB)\nRequirement already satisfied: rich in c:\\users\\1edwa\\anaconda3\\envs\\cryoprotect\\lib\\site-packages (from bandit) (13.9.4)\nRequirement already satisfied: colorama>=0.3.9 in c:\\users\\1...",
  "stderr": "  WARNING: The script pbr.exe is installed in 'C:\\Users\\1edwa\\anaconda3\\envs\\cryoprotect\\Scripts' which is not on PATH.\n  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.\n  WARNING: The scripts bandit-baseline.exe, bandit-config-generator.exe and bandit.exe are installed in 'C:\\Users\\1edwa\\anaconda3\\envs\\cryoprotect\\Scripts' which is not on PATH.\n  Consider adding this directory to PATH or, if you prefer to suppress this warning, u..."
}
            </div>

        </div>

    </div>

    <h2>Recommendations</h2>
    <table>
        <tr>
            <th>Category</th>
            <th>Test</th>
            <th>Status</th>
            <th>Recommendation</th>
        </tr>

        <tr>
            <td>CSRF Protection</td>
            <td>csrf_token_endpoint</td>
            <td class="failed">FAILED</td>
            <td>Implement a CSRF token endpoint that returns a valid CSRF token for client-side applications.</td>
        </tr>

        <tr>
            <td>CSRF Protection</td>
            <td>csrf_protection_enforced</td>
            <td class="failed">FAILED</td>
            <td>Ensure all state-changing endpoints (POST, PUT, PATCH, DELETE) validate CSRF tokens.</td>
        </tr>

        <tr>
            <td>Security Headers</td>
            <td>security_headers_present</td>
            <td class="failed">FAILED</td>
            <td>Implement all required security headers in the application responses. Missing headers: Content-Security-Policy, Strict-Transport-Security, X-Content-Type-Options, X-Frame-Options, X-XSS-Protection, Referrer-Policy, Permissions-Policy.</td>
        </tr>

        <tr>
            <td>Cookie Security</td>
            <td>secure_cookies</td>
            <td class="failed">FAILED</td>
            <td>Configure cookies with Secure, HttpOnly, and SameSite attributes.</td>
        </tr>

        <tr>
            <td>Encryption at Rest</td>
            <td>encryption_at_rest</td>
            <td class="failed">FAILED</td>
            <td>Implement proper encryption at rest for all sensitive data fields.</td>
        </tr>

        <tr>
            <td>Vulnerability Scanning</td>
            <td>vulnerability_scan_execution</td>
            <td class="failed">FAILED</td>
            <td>Fix vulnerability scanning script execution issues.</td>
        </tr>

    </table>
    
    <div class="footer">
        <p>This report was generated automatically as part of the security validation process.</p>
        <p>For questions or assistance, please contact the security team.</p>
    </div>
</body>
</html>
